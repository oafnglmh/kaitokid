<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Game Conan - Xé Túi Mù</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Baloo+2&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        margin: 0;
        font-family: "Baloo 2", cursive;
        background: url("https://wallpapercat.com/w/full/f/a/d/818185-3548x1996-desktop-hd-magic-kaito-background-image.jpg");
        overflow-x: hidden;
        background-size: cover;
      }

      #intro {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: black;
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #intro video {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      #game {
        display: none;
        text-align: center;
        padding: 20px;
        animation: fadeIn 1s ease-in-out;
        min-height: 100vh;
        background: url("banner.jpg") no-repeat center center/cover;
      }
      h1 {
        color: #ff4081;
        font-size: 2.5em;
        text-shadow: 2px 2px #fff;
        animation: bounce 2s infinite;
      }

      .bags {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin-top: 30px;
      }

      .bag {
        position: relative;
        cursor: pointer;
        border-radius: 15px;
        overflow: hidden;
        transition: transform 0.3s;
        background: #fff;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.25);
        animation: popIn 0.8s ease;
      }
      .bag:hover {
        transform: scale(1.1) rotate(-2deg);
      }
      .bag img {
        width: 100%;
        height: 150px;
        object-fit: cover;
      }
      .soldout {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.65);
        color: yellow;
        font-size: 1.8em;
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        text-shadow: 2px 2px 5px #000;
      }

      #questionBox {
        margin-top: 30px;
        padding: 20px;
        background: #fffbe7;
        border-radius: 20px;
        display: none;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
        animation: fadeInUp 0.6s ease;
      }
      .option {
        display: block;
        margin: 10px auto;
        padding: 12px 20px;
        background: #64b5f6;
        border: none;
        border-radius: 15px;
        cursor: pointer;
        font-size: 1.2em;
        transition: background 0.3s, transform 0.2s;
      }
      .option:hover {
        background: #1976d2;
        color: #fff;
        transform: scale(1.05);
      }

      .overlayVideo {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 3000;
        display: none;
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes fadeInUp {
        from {
          transform: translateY(40px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      @keyframes popIn {
        0% {
          transform: scale(0.5);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div id="intro">
      <video id="introVideo" autoplay muted>
        <source src="intro22.mp4" type="video/mp4" />
      </video>
    </div>

    <div id="game">
      <h1>Lật Bài Cùng Kaito Kid</h1>
      <div class="bags" id="bags"></div>

      <div id="questionBox">
        <h2 id="questionText"></h2>
        <div id="options"></div>
      </div>
    </div>

    <audio id="sound-correct" src="correct.mp3"></audio>
    <audio id="sound-wrong" src="wrong.mp3"></audio>

    <video id="videoCorrect" class="overlayVideo">
      <source src="correct.mp4" type="video/mp4" />
    </video>
    <video id="videoWrong" class="overlayVideo">
      <source src="wrong.mp4" type="video/mp4" />
    </video>
    <video id="videoEnd" class="overlayVideo">
      <source src="end.mp4" type="video/mp4" />
    </video>

    <script>
      const intro = document.getElementById("intro");
      const game = document.getElementById("game");
      const video = document.getElementById("introVideo");

      window.onload = () => {
  const video = document.getElementById("introVideo");
  video.play().catch(err => console.log("Autoplay muted only:", err));

  // Khi user click thì bật tiếng
  document.body.addEventListener("click", () => {
    video.muted = false;
    video.play();
  }, { once: true });
};


      setTimeout(() => {
        video.pause();
        video.currentTime = 0;
        intro.style.display = "none";
        game.style.display = "block";
      }, 19000);

      const questions = [
        {
          img: "https://bloganchoi.com/wp-content/uploads/2022/07/kaito-kid-1412-696x522.jpg",
          q: "Tên thật của Conan là gì?",
          options: ["Kudo Shinichi", "Kaito Kid", "Heiji", "Hattori"],
          answer: 0,
        },
        {
          img: "https://bloganchoi.com/wp-content/uploads/2022/07/kaito-kid-1412-696x522.jpg",
          q: "Bạn gái của Shinichi là ai?",
          options: ["Haibara", "Ran", "Sonoko", "Eri"],
          answer: 1,
        },
        {
          img: "https://bloganchoi.com/wp-content/uploads/2022/07/kaito-kid-1412-696x522.jpg",
          q: "Tên thật của Conan là gì?",
          options: ["Kudo Shinichi", "Kaito Kid", "Heiji", "Hattori"],
          answer: 0,
        },
        {
          img: "https://bloganchoi.com/wp-content/uploads/2022/07/kaito-kid-1412-696x522.jpg",
          q: "Bạn gái của Shinichi là ai?",
          options: ["Haibara", "Ran", "Sonoko", "Eri"],
          answer: 1,
        },
        {
          img: "https://bloganchoi.com/wp-content/uploads/2022/07/kaito-kid-1412-696x522.jpg",
          q: "Tên thật của Conan là gì?",
          options: ["Kudo Shinichi", "Kaito Kid", "Heiji", "Hattori"],
          answer: 0,
        },
        {
          img: "https://bloganchoi.com/wp-content/uploads/2022/07/kaito-kid-1412-696x522.jpg",
          q: "Bạn gái của Shinichi là ai?",
          options: ["Haibara", "Ran", "Sonoko", "Eri"],
          answer: 1,
        },
      ];

      const bagsDiv = document.getElementById("bags");
      questions.forEach((q, i) => {
        const bag = document.createElement("div");
        bag.className = "bag";
        bag.innerHTML = `<img src="${q.img}" alt="Túi ${i + 1}"/>`;
        bag.onclick = () => showQuestion(i, bag);
        bagsDiv.appendChild(bag);
      });

      const questionBox = document.getElementById("questionBox");
      const questionText = document.getElementById("questionText");
      const optionsDiv = document.getElementById("options");

      const videoCorrect = document.getElementById("videoCorrect");
      const videoWrong = document.getElementById("videoWrong");
      const videoEnd = document.getElementById("videoEnd");

      function showOverlayVideo(videoEl, callback) {
        videoEl.currentTime = Math.max(videoEl.duration - 3.5, 0);
        videoEl.style.display = "block";
        videoEl.play();
        videoEl.onended = () => {
          videoEl.style.display = "none";
          if (callback) callback();
        };
      }

      function showQuestion(index, bag) {
        const q = questions[index];
        questionBox.style.display = "block";
        questionText.innerText = q.q;
        optionsDiv.innerHTML = "";
        q.options.forEach((opt, i) => {
          const btn = document.createElement("button");
          btn.className = "option";
          btn.innerText = opt;
          btn.onclick = () => {
            checkAnswer(i === q.answer, bag);
          };
          optionsDiv.appendChild(btn);
        });
      }

      function checkAnswer(correct, bag) {
        if (bag.dataset.soldout) return;

        if (correct) {
          document.getElementById("sound-correct").play();
          showOverlayVideo(videoCorrect, checkEndGame);
        } else {
          document.getElementById("sound-wrong").play();
          showOverlayVideo(videoWrong, checkEndGame);
        }

        const sold = document.createElement("div");
        sold.className = "soldout";
        sold.innerText = "SOLD OUT";
        bag.appendChild(sold);
        bag.dataset.soldout = true;
        bag.style.pointerEvents = "none";

        questionBox.style.display = "none";
      }

      function checkEndGame() {
        const bags = document.querySelectorAll(".bag");
        const allSoldOut = Array.from(bags).every(
          (b) => b.dataset.soldout === "true"
        );
        if (allSoldOut) {
          showOverlayVideo(videoEnd);
        }
      }
    </script>
  </body>
</html>
